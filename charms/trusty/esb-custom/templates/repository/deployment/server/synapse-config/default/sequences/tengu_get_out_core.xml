<?xml version="1.0" encoding="UTF-8"?>
<sequence xmlns="http://ws.apache.org/ns/synapse" name="tengu_get_out_core">
   <log level="custom">
      <property name="test" value="test"/>
      <property xmlns:ns="http://org.apache.synapse/xsd"
                xmlns:rspec="http://www.geni.net/resources/rspec/3"
                name="hmaster"
                expression="$body/rspec:rspec/rspec:node[@client_id='hmaster']/rspec:host/@name"/>
      <property xmlns:ns="http://org.apache.synapse/xsd"
                xmlns:rspec="http://www.geni.net/resources/rspec/3"
                name="nimbus"
                expression="$body/rspec:rspec/rspec:node[@client_id='nimbus']/rspec:host/@name"/>
      <property xmlns:ns="http://org.apache.synapse/xsd"
                xmlns:rspec="http://www.geni.net/resources/rspec/3"
                name="esb"
                expression="$body/rspec:rspec/rspec:node[@client_id='esb']/rspec:host/@name"/>
   </log>
   <payloadFactory media-type="xml">
      <format>
         <ten:tengu xmlns:ten="http://tengu.ibcn.ugent.be/0/1/core"
                    xmlns:lnk="http://www.w3.org/1999/xhtml">
            <ten:platform>
               <ten:id>$1</ten:id>
               <ten:status>$2</ten:status>
               <lnk:link rel="jfed.slice" href="$3"/>
               <lnk:link rel="hadoop" method="ssh" href="ssh://$4"/>
               <lnk:link rel="storm" method="ssh" href="ssh://$5"/>
               <lnk:link rel="esb" method="get" href="https://$6:9443"/>
            </ten:platform>
         </ten:tengu>
      </format>
      <args>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              evaluator="xml"
              expression="get-property('id')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              evaluator="xml"
              expression="get-property('status')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              evaluator="xml"
              expression="get-property('slice')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              xmlns:rspec="http://www.geni.net/resources/rspec/3"
              evaluator="xml"
              expression="$body/rspec:rspec/rspec:node[@client_id='hmaster']/rspec:host/@name"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              xmlns:rspec="http://www.geni.net/resources/rspec/3"
              evaluator="xml"
              expression="$body/rspec:rspec/rspec:node[@client_id='nimbus']/rspec:host/@name"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd"
              xmlns:rspec="http://www.geni.net/resources/rspec/3"
              evaluator="xml"
              expression="$body/rspec:rspec/rspec:node[@client_id='esb']/rspec:host/@name"/>
      </args>
   </payloadFactory>
</sequence>
